# 実装計画: 楽観排他の追加

Java の repository の変換時に `update` と `delete` メソッドに楽観排他の処理を追加する。
排他は `updatedAt` の時刻印ロックで行う。

## タスク

1.  **Javaリポジトリの `update` メソッドの修正**
    *   `update` メソッドの引数に `updatedAt` を追加する。
    *   `UPDATE` 文の `WHERE` 句に `updatedAt` の一致条件を追加する。
    *   更新結果をチェックし、更新件数が0件の場合は `OptimisticLockingFailureException` をスローするように変更する。

2.  **Javaリポジトリの `delete` メソッドの修正**
    *   `delete` メソッドの引数に `updatedAt` を追加する。
    *   `DELETE` 文の `WHERE` 句に `updatedAt` の一致条件を追加する。
    *   削除結果をチェックし、削除件数が0件の場合は `OptimisticLockingFailureException` をスローするように変更する。

3.  **エンティティクラスへの `updatedAt` フィールドの追加**
    *   変換対象のエンティティクラスに `updatedAt` フィールド（例: `LocalDateTime` 型）が追加されるように、テンプレートまたは生成ロジックを修正する。

4.  **カスタム例外クラスの作成**
    *   楽観排他エラーを示すための `OptimisticLockingFailureException` （`RuntimeException` を継承）を作成する。
